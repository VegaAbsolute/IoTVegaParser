# Вега СИ-23 - счетчик импульсов LoRaWAN®


## Описание устройства
<img src="https://iotvega.com/content/ru/si/si23_232/ava.png" width="400" />

Счетчик импульсов Вега СИ-23 LoRaWAN® предназначен для организации автоматизированного сбора показаний с приборов учёта коммунальных ресурсов или промышленного оборудования. Счетчик импульсов имеет один цифровой интерфейс RS-232/RS-485 и два импульсных входа. Входы могут быть настроены как на подсчет импульсов так и на осуществление охранных функций.
Питание счетчика импульсов осуществляется от сети переменного тока, а в случаях перебоев подачи энергии счетчик импульсов автоматически перейдет на питание от резервного аккумулятора.


## Описание полей данных

### Пакет данных

Пакет данных (причина отправки: **byTime** - по времени, **bySecurityInput1Triggered** - сработал охранный вход 1, **bySecurityInput2Triggered** - сработал охранный вход 2, **byInput1ThresholdExceeded** - превышен порог на входе 1, **byInput2ThresholdExceeded** - превышен порог на входе 2, **byRequest** - по запросу, **byExternalPowerSwitchOff** - отключение внешнего питания, **byExternalPowerSwitchOn** - включение внешнего питания) приходит на порт 2 и содержит следующие поля:
- `decoder` - имя и версия дешифратора, тип данных `String`;
- `reason` - причина отправки пакета (**byTime** - по времени, **bySecurityInput1Triggered** - сработал охранный вход 1, **bySecurityInput2Triggered** - сработал охранный вход 2, **byModBusRtuData** - данные ModBus RTU, **byTransparentChannelData** - данные прозрачного канала, **byElectricityMeterPolling** - опрос электросчетчика, **byHeatMeterPolling** - опрос теплосчетчика, **byNoAnswerFromDevice** - нет ответа от устройства, **byNoAnswerFromModBusRequest** - нет ответа на запрос ModBus, **byDeviceCommunicationRestored** - связь с устройством восстановлена, **byDeviceCommunicationModBusRestored** - связь по ModBus восстановлена, **byInput1ThresholdExceeded** - превышен порог на входе 1, **byInput2ThresholdExceeded** - превышен порог на входе 2, **byRequest** - по запросу, **byExternalPowerSwitchOff** - отключение внешнего питания, **byExternalPowerSwitchOn** - включение внешнего питания), тип данных `String`;
- `time` - время снятия показаний, передаваемых в пакете в формате Unix-time (с), тип данных `Number`;
- `timeStringISO` - время снятия показаний, передаваемых в пакете в формате ISO, тип данных `String`;
- `temperature` - температура (°С), тип данных `Number`;
- `input1State` - состояние входа 1 (количество импульсов или состояние охранного входа), тип данных `Number`;
- `input2State` - состояние входа 2 (количество импульсов или состояние охранного входа), тип данных `Number`;
- `settings` - настройки устройства, тип данных `Object`, содержит следующие поля:
    - `ack` - подтверждение пакетов (**true** - включено, **false** - выключено), тип данных `Boolean`;
    - `input1Mode` - режим работы входа 1 (**0** - импульсный, **1** - охранный), тип данных `Number`;
    - `input2Mode` - режим работы входа 2 (**0** - импульсный, **1** - охранный), тип данных `Number`;
    - `period` - период выхода на связь (мин), тип данных `Number`;
    - `interfaceMode` - режим работы интерфейса (**transparent** - прозрачный, **metering** - счетчик, **modbus** - ModBus, **custom** - пользовательский), тип данных `String`;
- `chargePercent` - заряд батареи (%), тип данных `Number`;
- `statusDecode` - состояние расшифровки данных (**true** если расшифровка успешна и **false** если неуспешна), тип данных `Boolean`.

### Пакет данных ModBus RTU (тип 04)

Пакет данных ModBus RTU (причина отправки: **byModBusRtuData** - данные ModBus RTU) приходит на порт 2 и содержит следующие поля:
- `decoder` - имя и версия дешифратора, тип данных `String`;
- `settingNumber` - номер настройки, тип данных `Number`;
- `totalSize` - общий размер данных, тип данных `Number`;
- `packetSize` - размер текущего пакета, тип данных `Number`;
- `sequenceNumber` - порядковый номер пакета, тип данных `Number`;
- `packetCount` - общее количество пакетов, тип данных `Number`;
- `startRegisterAddr` - начальный адрес регистра, тип данных `Number`;
- `data` - данные ModBus, тип данных `Array`;
- `statusDecode` - состояние расшифровки данных (**true** если расшифровка успешна и **false** если неуспешна), тип данных `Boolean`.

### Пакет данных прозрачного канала (тип 05)

Пакет данных прозрачного канала (причина отправки: **byTransparentChannelData** - данные прозрачного канала) приходит на порт 2 и содержит следующие поля:
- `decoder` - имя и версия дешифратора, тип данных `String`;
- `time` - время снятия показаний, передаваемых в пакете в формате Unix-time (с), тип данных `Number`;
- `timeStringISO` - время снятия показаний, передаваемых в пакете в формате ISO, тип данных `String`;
- `settingNumber` - номер настройки, тип данных `Number`;
- `totalSize` - общий размер данных, тип данных `Number`;
- `packetSize` - размер текущего пакета, тип данных `Number`;
- `sequenceNumber` - порядковый номер пакета, тип данных `Number`;
- `packetCount` - общее количество пакетов, тип данных `Number`;
- `data` - данные прозрачного канала, тип данных `Array`;
- `statusDecode` - состояние расшифровки данных (**true** если расшифровка успешна и **false** если неуспешна), тип данных `Boolean`.

### Пакет данных прозрачного канала (тип 13)

Пакет данных прозрачного канала (причина отправки: **byTransparentChannelData** - данные прозрачного канала) приходит на порт 2 и содержит следующие поля:
- `decoder` - имя и версия дешифратора, тип данных `String`;
- `settingNumber` - номер настройки, тип данных `Number`;
- `totalSize` - общий размер данных, тип данных `Number`;
- `packetSize` - размер текущего пакета, тип данных `Number`;
- `sequenceNumber` - порядковый номер пакета, тип данных `Number`;
- `packetCount` - общее количество пакетов, тип данных `Number`;
- `data` - данные прозрачного канала, тип данных `Array`;
- `statusDecode` - состояние расшифровки данных (**true** если расшифровка успешна и **false** если неуспешна), тип данных `Boolean`.

### Пакет данных ModBus RTU (тип 06)

Пакет данных ModBus RTU (причина отправки: **byModBusRtuData** - данные ModBus RTU) приходит на порт 2 и содержит следующие поля:
- `decoder` - имя и версия дешифратора, тип данных `String`;
- `time` - время снятия показаний, передаваемых в пакете в формате Unix-time (с), тип данных `Number`;
- `timeStringISO` - время снятия показаний, передаваемых в пакете в формате ISO, тип данных `String`;
- `settingNumber` - номер настройки, тип данных `Number`;
- `totalSize` - общий размер данных, тип данных `Number`;
- `packetSize` - размер текущего пакета, тип данных `Number`;
- `sequenceNumber` - порядковый номер пакета, тип данных `Number`;
- `packetCount` - общее количество пакетов, тип данных `Number`;
- `startRegisterAddr` - начальный адрес регистра, тип данных `Number`;
- `data` - данные ModBus, тип данных `Array`;
- `statusDecode` - состояние расшифровки данных (**true** если расшифровка успешна и **false** если неуспешна), тип данных `Boolean`.

### Пакет данных электросчетчика

Пакет данных электросчетчика (причина отправки: **byElectricityMeterPolling** - опрос электросчетчика) приходит на порт 2 и содержит следующие поля:
- `decoder` - имя и версия дешифратора, тип данных `String`;
- `meterType` - тип счетчика, тип данных `String`;
- `serialNumber` - серийный номер счетчика, тип данных `Number`;
- `isPollSuccess` - флаг успешности опроса, тип данных `Boolean`;
- `time` - время снятия показаний, передаваемых в пакете в формате Unix-time (с), тип данных `Number`;
- `timeStringISO` - время снятия показаний, передаваемых в пакете в формате ISO, тип данных `String`;
- `tariff1Reading` - показания по тарифу 1 (кВт*ч), тип данных `Number`;
- `tariff2Reading` - показания по тарифу 2 (кВт*ч), тип данных `Number`;
- `tariff3Reading` - показания по тарифу 3 (кВт*ч), тип данных `Number`;
- `tariff4Reading` - показания по тарифу 4 (кВт*ч), тип данных `Number`;
- `statusDecode` - состояние расшифровки данных (**true** если расшифровка успешна и **false** если неуспешна), тип данных `Boolean`.

### Пакет данных теплосчетчика

Пакет данных теплосчетчика (причина отправки: **byHeatMeterPolling** - опрос теплосчетчика) приходит на порт 2 и содержит следующие поля:
- `decoder` - имя и версия дешифратора, тип данных `String`;
- `meterType` - тип счетчика, тип данных `String`;
- `serial` - серийный номер счетчика, тип данных `Number`;
- `time` - время снятия показаний, передаваемых в пакете в формате Unix-time (с), тип данных `Number`;
- `timeStringISO` - время снятия показаний, передаваемых в пакете в формате ISO, тип данных `String`;
- `energyConsumed` - потребленная энергия (Гкал), тип данных `Number`;
- `totalVolumeCoolant` - общий объем теплоносителя (м³), тип данных `Number`;
- `operatingTime` - время наработки (ч), тип данных `Number`;
- `temperatureSupply` - температура подачи (°C), тип данных `Number`;
- `temperatureReturn` - температура обратки (°C), тип данных `Number`;
- `currentFlowCoolant` - текущий расход теплоносителя (м³/ч), тип данных `Number`;
- `currentFlowCoolant32` - текущий расход теплоносителя (32 бита) (м³/ч), тип данных `Number`;
- `power` - мощность (кВт), тип данных `Number`;
- `environment` - тип среды, тип данных `String`;
- `statusDecode` - состояние расшифровки данных (**true** если расшифровка успешна и **false** если неуспешна), тип данных `Boolean`.

### Пакет отсутствия ответа

Пакет отсутствия ответа (причина отправки: **byNoAnswerFromDevice** - нет ответа от устройства) приходит на порт 2 и содержит следующие поля:
- `decoder` - имя и версия дешифратора, тип данных `String`;
- `settingNumber` - номер настройки, тип данных `Number`;
- `meterType` - тип счетчика, тип данных `String`;
- `serial` - серийный номер счетчика, тип данных `Number`;
- `statusDecode` - состояние расшифровки данных (**true** если расшифровка успешна и **false** если неуспешна), тип данных `Boolean`.

### Пакет отсутствия ответа ModBus

Пакет отсутствия ответа ModBus (причина отправки: **byNoAnswerFromModBusRequest** - нет ответа на запрос ModBus) приходит на порт 2 и содержит следующие поля:
- `decoder` - имя и версия дешифратора, тип данных `String`;
- `settingNumber` - номер настройки, тип данных `Number`;
- `statusDecode` - состояние расшифровки данных (**true** если расшифровка успешна и **false** если неуспешна), тип данных `Boolean`.

### Пакет восстановления связи

Пакет восстановления связи (причина отправки: **byDeviceCommunicationRestored** - связь с устройством восстановлена) приходит на порт 2 и содержит следующие поля:
- `decoder` - имя и версия дешифратора, тип данных `String`;
- `settingNumber` - номер настройки, тип данных `Number`;
- `meterType` - тип счетчика, тип данных `String`;
- `serial` - серийный номер счетчика, тип данных `Number`;
- `statusDecode` - состояние расшифровки данных (**true** если расшифровка успешна и **false** если неуспешна), тип данных `Boolean`.

### Пакет восстановления связи ModBus

Пакет восстановления связи ModBus (причина отправки: **byDeviceCommunicationModBusRestored** - связь по ModBus восстановлена) приходит на порт 2 и содержит следующие поля:
- `decoder` - имя и версия дешифратора, тип данных `String`;
- `settingNumber` - номер настройки, тип данных `Number`;
- `statusDecode` - состояние расшифровки данных (**true** если расшифровка успешна и **false** если неуспешна), тип данных `Boolean`.

### Пакет с запросом корректировки времени

Пакет с запросом корректировки времени приходит на порт 4 и содержит следующие поля:
- `decoder` - имя и версия дешифратора, тип данных `String`;
- `time` - время снятия показаний, передаваемых в пакете в формате Unix-time (с), тип данных `Number`;
- `timeStringISO` - время снятия показаний, передаваемых в пакете в формате ISO, тип данных `String`;
- `type` - тип пакета, тип данных `String`;
- `statusDecode` - состояние расшифровки данных (**true** если расшифровка успешна и **false** если неуспешна), тип данных `Boolean`.

### Пакет с настройками

Пакет с настройками приходит на порт 3 и содержит следующие поля:
- `decoder` - имя и версия дешифратора, тип данных `String`;
- `settings` - текущие значения настроек устройства, тип данных `Object` (ключами объекта являются номера параметров);
- `statusDecode` - состояние расшифровки данных (**true** если расшифровка успешна и **false** если неуспешна), тип данных `Boolean`;
- `type` - тип пакета, тип данных `String`.

Объект параметра содержит следующие поля:
- `id` - номер параметра, тип данных `Number`;
- `length` - длина значения параметра (байт), тип данных `Number`;
- `name` - имя параметра, тип данных `String`;
- `rawValue` - необработанное значение параметра, тип данных `String`;
- `value` - значение параметра, тип данных зависит от параметра.
